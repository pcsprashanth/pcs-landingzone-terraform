{
    "name": "Azure-Cloud-Security-BenchMark",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "properties": {
      "name": "Cloud-Security-BenchMark",  
      "displayName": "Cloud security benchmark",
      "policyType": "Custom",
      "description": "The Microsoft cloud security benchmark initiative represents the policies and controls implementing security recommendations defined in Microsoft cloud security benchmark, see https://aka.ms/azsecbm. This also serves as the Microsoft Defender for Cloud default policy initiative. You can directly assign this initiative, or manage its policies and compliance results within Microsoft Defender for Cloud.",
      "metadata": {
        "version": "57.11.1",
        "category": "Security Center"
      },
      "parameters": {
        "installLogAnalyticsAgentOnVmMonitoringEffect": {
            "type": "String",
            "metadata": {
              "displayName": "Log Analytics agent should be installed on your virtual machine for Microsoft Defender for Cloud monitoring",
              "description": "This policy audits any Windows/Linux virtual machines (VMs) if the Log Analytics agent is not installed which Security Center uses to monitor for security vulnerabilities and threats"
            },
            "allowedValues": [
              "AuditIfNotExists",
              "Disabled"
            ],
            "defaultValue": "AuditIfNotExists"
          },
          "installLogAnalyticsAgentOnVmssMonitoringEffect": {
            "type": "String",
            "metadata": {
              "displayName": "Log Analytics agent should be installed on your virtual machine scale sets for Microsoft Defender for Cloud monitoring",
              "description": "Security Center collects data from your Azure virtual machines (VMs) to monitor for security vulnerabilities and threats."
            },
            "allowedValues": [
              "AuditIfNotExists",
              "Disabled"
            ],
            "defaultValue": "AuditIfNotExists"
          }
      },
      "policyDefinitions": [
        {
          "policyDefinitionReferenceId": "installLogAnalyticsAgentOnVmMonitoring",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4fe33eb-e377-4efb-ab31-0784311bc499",
          "parameters": {
            "effect": {
              "value": "[parameters('installLogAnalyticsAgentOnVmMonitoringEffect')]"
            }
          },
          "groupNames": []
        },
        {
          "policyDefinitionReferenceId": "installLogAnalyticsAgentOnVmssMonitoring",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a3a6ea0c-e018-4933-9ef0-5aaa1501449b",
          "parameters": {
            "effect": {
              "value": "[parameters('installLogAnalyticsAgentOnVmssMonitoringEffect')]"
            }
          },
          "groupNames": []
        }
      ],
      "policyDefinitionGroups": null
   }

}
