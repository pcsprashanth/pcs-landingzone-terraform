{
    "name": "itau-key-vault",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
    "properties": {
      "policyType": "Custom",
      "displayName": "Key Vault Initiatve",
      "description": "Contains the core Key Vault policies applicable to the org",
      "metadata": {
        "version": "1.0.0",
        "category": "Key Vault"
      },
      "parameters": {},
      "policyDefinitions": [
        {
            "policyDefinitionReferenceId": "[Preview]: Azure Key Vault should use RBAC permission model",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5",
            "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "Azure Key Vault should disable public network access",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b",
            "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "Certificates should use allowed key types",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f",
            "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "Certificates using RSA cryptography should have the specified minimum key size",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0",
            "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "[Preview]: Azure Key Vault Managed HSM should disable public network access",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f",
          "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "Key vaults should have soft delete enabled",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
            "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/951af2fa-529b-416e-ab6e-066fd85ac459",
            "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "[Preview]: Azure Key Vault Managed HSM should disable public network access",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f",
            "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "[Preview]: Azure Key Vault Managed HSM should use private link",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/59fee2f4-d439-4f1b-9b9a-982e1474bfd8",
            "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "Azure Key Vault Managed HSM should have purge protection enabled",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c39ba22d-4428-4149-b981-70acb31fc383",
            "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "Deploy - Configure diagnostic settings for Azure Key Vault to Log Analytics workspace",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/951af2fa-529b-416e-ab6e-066fd85ac459",
            "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "Deploy - Configure diagnostic settings to an Event Hub to be enabled on Azure Key Vault Managed HSM",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6d2c800-5230-4a40-bff3-8268b4987d42",
            "parameters": {}
        },
        {
            "policyDefinitionReferenceId": "Resource logs in Azure Key Vault Managed HSM should be enabled",
            "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a2a5b911-5617-447e-a49e-59dbe0e0434b",
            "parameters": {}
        }
    ],
      "policyDefinitionGroups": null
    }
}