{
    "name": "itau-storageaccount",
    "type": "Microsoft.Authorization/policySetDefinitions",
    "apiVersion": "2023-31-05",
    "scope": null,
    "properties": {
      "policyType": "Custom",
      "displayName": "ITAU - Storage Account v1",
      "description": "This initiative contains the policies necessary to limit storage account",
      "metadata": {
        "version": "1.0.2",
        "category": "Storage"
      },
      "parameters": {},
      "policyDefinitions": [
        {
          "policyDefinitionReferenceId": "Storage-account-secure-transfer",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Storage-account-should-have-infrastructure-encryption",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4733ea7b-a883-42fe-8cac-97454c2a9e4a",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Define-physical-key-management-process",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/51e4b233-8ee3-8bdc-8f5f-f33bd0d229b7",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Define-Cryptographic-use",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c4ccd607-702b-8ae6-8eeb-fc3339cd4b42",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Define-Organizational-Requirements-for-cryptographic-key-management",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d661e9eb-4e15-5ba1-6f02-cdc467db0d6c",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Determine-assertion-requirements",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7a0ecd94-3699-5273-76a5-edb8499f655a",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Issue-public-key-certificates",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/97d91b33-7050-237b-3e23-a77d57d84e13",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Manage-symmetric-cryptographic-keys",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9c276cf3-596f-581a-7fbd-f5e46edaa0f4",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Restrict-access-to-private-keys",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8d140e8b-76c7-77de-1d46-ed1b2e112444",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Audit-privileged-functions",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f26af0b1-65b6-689a-a03f-352ad2d00f98",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Audit-user-account-status",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/49c23d9b-02b0-0e42-4f94-e8cef1b8381b",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Configure-Azure-Audit-capabilities",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a3e98638-51d4-4e28-910a-60e98c1a756f",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Determine-auditable-events",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2f67e567-03db-9d1f-67dc-b6ffb91312f4",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Review-audit-data",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6625638f-3ba1-7404-5983-0ea33d719d34",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Disable-authenticators-upon-termination",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d9d48ffb-0d8c-0bd5-5f31-5a5826d19f10",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Revoke-privileged-roles-as-appropriate",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/32f22cfa-770b-057c-965b-450898425519",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Terminate-user-session-automatically",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4502e506-5f35-0df4-684f-b326e3cc7093",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Storage-account-public-access-should-be-disallowed",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Storage-account-should-restrict-network-access",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Storage-accounts-should-restrict-network-access-using-virtual-network-rules",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Storage-accounts-should-allow-access-from-trusted-Microsoft-services",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9d007d0-c057-4772-b18c-01e546713bcd",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Storage-accounts-should-use-private-link",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6edd7eda-6dd8-40f7-810d-67160c639cd9",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Storage-accounts-should-use-customer-managed-key-for-encryption",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Storage-accounts-should-have-the-specified-minimum-TLS-version",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe83a0eb-a853-422d-aac2-1bffd182c5d0",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Storage account encryption scopes should use customer-managed keys to encrypt data at rest",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b5ec538c-daa0-4006-8596-35468b9148e8",
          "parameters": {}
        },
        {
          "policyDefinitionReferenceId": "Deploy-Defender-for-Storage-on-storage-accounts",
          "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c",
          "parameters": {}
        }
      ],
      "policyDefinitionGroups": null
    }
}